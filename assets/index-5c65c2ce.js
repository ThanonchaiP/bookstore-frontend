import{r as v,R as x,j as o}from"./index-eb84028e.js";import{u as Y,c as K,a as z,h as k}from"./review.sevice-3e142ee6.js";import{L as D,u as B}from"./index-4ca9e7fe.js";import{g as A}from"./order.service-cf8e1f71.js";import{P as W}from"./index-a398ceba.js";import{Q as X}from"./react-toastify.esm-b4929cd0.js";import{A as G,K as _,g as q,M as Q}from"./ConfirmDialog-246d4833.js";import{k as C,b as H,z as L,c as $,_ as O,p as V,h as J,A as U,G as Z,N as ee,E as te,u as w}from"./useTranslation-ad94cc8a.js";import{T as ae}from"./index-b9d21631.js";import{B as re}from"./index-7f3b26ed.js";import{n as se}from"./not-product-3f66fb0b.js";import"./index.esm-81e7d11a.js";import"./ResizeObserver.es-f4289e8a.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const ne=oe;var P=function(a,c){return v.createElement(G,C(C({},a),{},{ref:c,icon:ne}))};P.displayName="StarFilled";const le=v.forwardRef(P);function ie(t){var a=t.pageXOffset,c="scrollLeft";if(typeof a!="number"){var r=t.document;a=r.documentElement[c],typeof a!="number"&&(a=r.body[c])}return a}function ce(t){var a,c,r=t.ownerDocument,e=r.body,n=r&&r.documentElement,s=t.getBoundingClientRect();return a=s.left,c=s.top,a-=n.clientLeft||e.clientLeft||0,c-=n.clientTop||e.clientTop||0,{left:a,top:c}}function de(t){var a=ce(t),c=t.ownerDocument,r=c.defaultView||c.parentWindow;return a.left+=ie(r),a.left}var ue=function(t){H(c,t);var a=L(c);function c(){var r;$(this,c);for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return r=a.call.apply(a,[this].concat(n)),r.onHover=function(l){var i=r.props,d=i.onHover,u=i.index;d(l,u)},r.onClick=function(l){var i=r.props,d=i.onClick,u=i.index;d(l,u)},r.onKeyDown=function(l){var i=r.props,d=i.onClick,u=i.index;l.keyCode===13&&d(l,u)},r}return O(c,[{key:"getClassName",value:function(){var e=this.props,n=e.prefixCls,s=e.index,l=e.value,i=e.allowHalf,d=e.focused,u=s+1,f=n;return l===0&&s===0&&d?f+=" ".concat(n,"-focused"):i&&l+.5>=u&&l<u?(f+=" ".concat(n,"-half ").concat(n,"-active"),d&&(f+=" ".concat(n,"-focused"))):(f+=u<=l?" ".concat(n,"-full"):" ".concat(n,"-zero"),u===l&&d&&(f+=" ".concat(n,"-focused"))),f}},{key:"render",value:function(){var e=this.onHover,n=this.onClick,s=this.onKeyDown,l=this.props,i=l.disabled,d=l.prefixCls,u=l.character,f=l.characterRender,h=l.index,m=l.count,p=l.value,g=typeof u=="function"?u(this.props):u,b=x.createElement("li",{className:this.getClassName()},x.createElement("div",{onClick:i?null:n,onKeyDown:i?null:s,onMouseMove:i?null:e,role:"radio","aria-checked":p>h?"true":"false","aria-posinset":h+1,"aria-setsize":m,tabIndex:i?-1:0},x.createElement("div",{className:"".concat(d,"-first")},g),x.createElement("div",{className:"".concat(d,"-second")},g)));return f&&(b=f(b,this.props)),b}}]),c}(x.Component);function N(){}var F=function(t){H(c,t);var a=L(c);function c(r){var e;$(this,c),e=a.call(this,r),e.stars=void 0,e.rate=void 0,e.onHover=function(s,l){var i=e.props.onHoverChange,d=e.getStarValue(l,s.pageX),u=e.state.cleanedValue;d!==u&&e.setState({hoverValue:d,cleanedValue:null}),i(d)},e.onMouseLeave=function(){var s=e.props.onHoverChange;e.setState({hoverValue:void 0,cleanedValue:null}),s(void 0)},e.onClick=function(s,l){var i=e.props.allowClear,d=e.state.value,u=e.getStarValue(l,s.pageX),f=!1;i&&(f=u===d),e.onMouseLeave(),e.changeValue(f?0:u),e.setState({cleanedValue:f?u:null})},e.onFocus=function(){var s=e.props.onFocus;e.setState({focused:!0}),s&&s()},e.onBlur=function(){var s=e.props.onBlur;e.setState({focused:!1}),s&&s()},e.onKeyDown=function(s){var l=s.keyCode,i=e.props,d=i.count,u=i.allowHalf,f=i.onKeyDown,h=i.direction,m=h==="rtl",p=e.state.value;l===_.RIGHT&&p<d&&!m?(u?p+=.5:p+=1,e.changeValue(p),s.preventDefault()):l===_.LEFT&&p>0&&!m||l===_.RIGHT&&p>0&&m?(u?p-=.5:p-=1,e.changeValue(p),s.preventDefault()):l===_.LEFT&&p<d&&m&&(u?p+=.5:p+=1,e.changeValue(p),s.preventDefault()),f&&f(s)},e.saveRef=function(s){return function(l){e.stars[s]=l}},e.saveRate=function(s){e.rate=s};var n=r.value;return n===void 0&&(n=r.defaultValue),e.stars={},e.state={value:n,focused:!1,cleanedValue:null},e}return O(c,[{key:"componentDidMount",value:function(){var e=this.props,n=e.autoFocus,s=e.disabled;n&&!s&&this.focus()}},{key:"getStarDOM",value:function(e){return q(this.stars[e])}},{key:"getStarValue",value:function(e,n){var s=this.props,l=s.allowHalf,i=s.direction,d=i==="rtl",u=e+1;if(l){var f=this.getStarDOM(e),h=de(f),m=f.clientWidth;(d&&n-h>m/2||!d&&n-h<m/2)&&(u-=.5)}return u}},{key:"focus",value:function(){var e=this.props.disabled;e||this.rate.focus()}},{key:"blur",value:function(){var e=this.props.disabled;e||this.rate.blur()}},{key:"changeValue",value:function(e){var n=this.props.onChange;"value"in this.props||this.setState({value:e}),n(e)}},{key:"render",value:function(){for(var e=this.props,n=e.count,s=e.allowHalf,l=e.style,i=e.prefixCls,d=e.disabled,u=e.className,f=e.character,h=e.characterRender,m=e.tabIndex,p=e.direction,g=this.state,b=g.value,S=g.hoverValue,E=g.focused,j=[],I=d?"".concat(i,"-disabled"):"",y=0;y<n;y+=1)j.push(x.createElement(ue,{ref:this.saveRef(y),index:y,count:n,disabled:d,prefixCls:"".concat(i,"-star"),allowHalf:s,value:S===void 0?b:S,onClick:this.onClick,onHover:this.onHover,key:y,character:f,characterRender:h,focused:E}));var T=V(i,I,u,J({},"".concat(i,"-rtl"),p==="rtl"));return x.createElement("ul",{className:T,style:l,onMouseLeave:d?null:this.onMouseLeave,tabIndex:d?-1:m,onFocus:d?null:this.onFocus,onBlur:d?null:this.onBlur,onKeyDown:d?null:this.onKeyDown,ref:this.saveRate,role:"radiogroup"},j)}}],[{key:"getDerivedStateFromProps",value:function(e,n){return"value"in e&&e.value!==void 0?C(C({},n),{},{value:e.value}):n}}]),c}(x.Component);F.defaultProps={defaultValue:0,count:5,allowHalf:!1,allowClear:!0,style:{},prefixCls:"rc-rate",onChange:N,character:"★",onHoverChange:N,tabIndex:0,direction:"ltr"};const fe=t=>{const{componentCls:a}=t;return{[`${a}-star`]:{position:"relative",display:"inline-block",color:"inherit",cursor:"pointer","&:not(:last-child)":{marginInlineEnd:t.marginXS},"> div":{transition:`all ${t.motionDurationMid}, outline 0s`,"&:hover":{transform:t.rateStarHoverScale},"&:focus":{outline:0},"&:focus-visible":{outline:`${t.lineWidth}px dashed ${t.rateStarColor}`,transform:t.rateStarHoverScale}},"&-first, &-second":{color:t.defaultColor,transition:`all ${t.motionDurationMid}`,userSelect:"none",[t.iconCls]:{verticalAlign:"middle"}},"&-first":{position:"absolute",top:0,insetInlineStart:0,width:"50%",height:"100%",overflow:"hidden",opacity:0},[`&-half ${a}-star-first, &-half ${a}-star-second`]:{opacity:1},[`&-half ${a}-star-first, &-full ${a}-star-second`]:{color:"inherit"}}}},me=t=>({[`&-rtl${t.componentCls}`]:{direction:"rtl"}}),pe=t=>{const{componentCls:a}=t;return{[a]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ee(t)),{display:"inline-block",margin:0,padding:0,color:t.rateStarColor,fontSize:t.rateStarSize,lineHeight:"unset",listStyle:"none",outline:"none",[`&-disabled${a} ${a}-star`]:{cursor:"default","&:hover":{transform:"scale(1)"}}}),fe(t)),{[`+ ${a}-text`]:{display:"inline-block",marginInlineStart:t.marginXS,fontSize:t.fontSize}}),me(t))}},he=U("Rate",t=>{const{colorFillContent:a}=t,c=Z(t,{rateStarColor:t["yellow-6"],rateStarSize:t.controlHeightLG*.5,rateStarHoverScale:"scale(1.1)",defaultColor:a});return[pe(c)]});var ve=globalThis&&globalThis.__rest||function(t,a){var c={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&a.indexOf(r)<0&&(c[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,r=Object.getOwnPropertySymbols(t);e<r.length;e++)a.indexOf(r[e])<0&&Object.prototype.propertyIsEnumerable.call(t,r[e])&&(c[r[e]]=t[r[e]]);return c};const ge=v.forwardRef((t,a)=>{const{prefixCls:c,tooltips:r,character:e=v.createElement(le,null)}=t,n=ve(t,["prefixCls","tooltips","character"]),s=(h,m)=>{let{index:p}=m;return r?v.createElement(ae,{title:r[p]},h):h},{getPrefixCls:l,direction:i}=v.useContext(te),d=l("rate",c),[u,f]=he(d);return u(v.createElement(F,Object.assign({ref:a,character:e,characterRender:s},n,{className:V(t.className,f),prefixCls:d,direction:i})))}),xe=ge,be=({open:t,item:a,handleClose:c})=>{const{t:r}=w(),[e,n]=v.useState({rating:0,body:""}),[s,l]=v.useState(!1),i=f=>{s&&l(!1),n(h=>({...h,rating:f}))},d=f=>n(h=>({...h,body:f})),u=async()=>{try{if(e.rating===0){l(!0);return}if(a.review){const{id:f}=a.review;await Y(f,{...e})}else await K({...e,bookId:a.book.id,orderItemId:a.id});X.success("Review Submitted Successfully.",{autoClose:2e3}),c(!a.review)}catch(f){console.log(f)}};return v.useEffect(()=>{const f=async h=>{const m=await z(h),{body:p,rating:g}=m.data;n({body:p,rating:g})};a.review&&f(a.review.id)},[a.review]),o.jsxs(Q,{open:t,width:500,footer:null,onCancel:()=>c(),closable:!1,children:[o.jsx("h1",{className:"text-xl font-medium",children:r("user.rateProduct")}),a&&o.jsxs("div",{className:"mt-4",children:[o.jsx("img",{className:"shadow-md mx-auto mb-4",width:80,src:a.book.image,alt:a.book.name,crossOrigin:"anonymous"}),o.jsx("p",{className:"text-base font-bold",children:a.book.name}),o.jsxs("p",{className:"text-gray-400",children:["฿",a.book.price]}),o.jsx("h3",{className:"text-base font-semibold mt-4",children:r("user.productQuality")}),o.jsx(xe,{className:"",value:e.rating,onChange:i}),s&&o.jsx("p",{className:"text-red-500 font-medium",children:"กรุณาเลือกคะแนนสินค้า"}),o.jsx("h3",{className:"text-base font-semibold mt-4",children:r("user.reviewMessage")}),o.jsx("textarea",{className:"w-full outline-none p-2 border-[2px] border-gray-300 rounded-sm focus:border-[#554994]",rows:3,cols:33,value:e.body,onChange:f=>d(f.target.value)}),o.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[o.jsx("button",{className:"w-[140px] py-2 font-semibold duration-300 rounded-md bg-gray-100 hover:bg-gray-300",onClick:()=>c(),children:r("user.cancel")}),o.jsx("button",{className:"w-[140px] py-2 font-semibold duration-300 bg-[#554994] text-white rounded-md hover:bg-[#453a83]",onClick:u,children:r("user.submit")})]})]})]})},ye=v.memo(be),M={"item-container":"_item-container_1jcbw_1","product-img":"_product-img_1jcbw_12"},_e=({item:t,onOpenPopup:a})=>{const{t:c}=w();return o.jsxs("div",{className:M["item-container"],children:[o.jsx("div",{className:M["product-img"],children:o.jsx("img",{src:t.book.image,alt:t.book.name,crossOrigin:"anonymous"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx(D,{to:`/product-detail/${t.book.id}`,className:"text-base font-medium",children:t.book.name}),o.jsxs("p",{children:[c("order.quantity"),": ",t.quantity]}),o.jsxs("p",{children:[c("order.price"),": ฿",(+t.book.price).toFixed(2)]}),o.jsxs("div",{className:"flex flex-col justify-between md:flex-row md:items-center",children:[o.jsx("p",{className:"text-[#1a9cb7] cursor-pointer hover:underline",onClick:()=>a(t),children:t.review?"แก้ไขคะแนนสินค้า":"ให้คะแนนสินค้า"}),o.jsxs("h4",{className:"text-base font-semibold text-[#554994] mt-2 md:mt-0",children:["฿",(t.quantity*Number(t.book.price)).toFixed(2)]})]})]})]},t.id)},Ce=v.memo(_e),R={"order-item":"_order-item_1n5ev_1","order-item__header":"_order-item__header_1n5ev_7"};//! moment.js locale configuration
k.defineLocale("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),monthsParseExact:!0,weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},meridiemParse:/ก่อนเที่ยง|หลังเที่ยง/,isPM:function(t){return t==="หลังเที่ยง"},meridiem:function(t,a,c){return t<12?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",ss:"%d วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",w:"1 สัปดาห์",ww:"%d สัปดาห์",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}});const Pe=()=>{const{t}=w();let[a,c]=B();const[r,e]=v.useState(!1),[n,s]=v.useState(),l=a.get("page")||"1",{data:i,mutate:d}=A(+l),u=v.useCallback(m=>{c({page:m.toString()})},[]),f=v.useCallback(m=>{s(m),e(!0)},[]),h=v.useCallback(m=>{m&&d(),s(void 0),e(!1)},[]);return o.jsxs("div",{className:"p-4 rounded-md shadow-lg",children:[o.jsx("h1",{className:"text-lg font-medium mb-8",children:t("order.myOrder")}),i&&i.data.length>0?o.jsxs(o.Fragment,{children:[i.data.map(m=>o.jsxs("div",{className:R["order-item"],children:[o.jsxs("div",{className:R["order-item__header"],children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"font-medium md:text-base",children:[t("order.order")," ",o.jsxs("span",{className:"text-[#554994]",children:["#",m.orderId]})]}),o.jsxs("h4",{className:"font-medium md:text-base",children:[t("order.orderDate")," ",k(m.orderDate).locale("th").format("DD MMMM YYYY เวลา HH:mm")]})]}),o.jsxs("h4",{className:"font-medium md:text-base",children:[t("order.orderTotal"),": ",o.jsxs("span",{className:"text-lg text-[#554994]",children:["฿",m.totalPrice]})]})]}),m.orderItems.map(p=>o.jsx(Ce,{item:p,onOpenPopup:f},p.id))]},m.id)),o.jsx(W,{className:"justify-end py-4",currentPage:i.meta.page||1,pageSize:i.meta.limit,totalCount:i.meta.itemCount||0,onPageChange:u})]}):o.jsxs(o.Fragment,{children:[o.jsx("img",{className:"mx-auto md:min-h-[212px]",src:se,alt:"not found"}),o.jsx("h3",{className:"text-2xl font-semibold text-center text-[#554994] my-5",children:t("order.notFoundMessage")}),o.jsx(D,{to:"/products-filter",className:"block text-center md:pb-10",children:o.jsx(re,{className:"w-[160px] mt-3",children:t("cart.shoppingNow")})})]}),n&&o.jsx(ye,{open:r,item:n,handleClose:h})]})};export{Pe as default};
